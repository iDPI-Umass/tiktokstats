import json
import yt_dlp
import pandas as pd
from tqdm import tqdm
from time import sleep
from concurrent.futures import ThreadPoolExecutor, as_completed


sampled_ids = ['7346646468679191813', '7346646468679208197', '7346646468679224581', '7346646468679257349', '7346646468679273733', '7346646468700163333', '7346646468700196101', '7346646468700228869', '7346646468700245253', '7346646468700261637', '7346646468712729863', '7346646468712746247', '7346646468712762631', '7346646468712779015', '7346646468712795399', '7346646468712828167', '7346646468712844551', '7346646468712877319', '7346646468721151238', '7346646468721216774', '7346646468721249542', '7346646468775660832', '7346646468775677191', '7346646468775693600', '7346646468775726368', '7346646468775742727', '7346646468775759136', '7346646468775791879', '7346646468817603845', '7346646468817587461', '7346646468817620229', '7346646468817636613', '7346646468817669381', '7346646468817718533', '7346646468830203182', '7346646468830235950', '7346646468830268718', '7346646468830301486', '7346646468830432558', '7346646468855336197', '7346646468855385349', '7346646468855401733', '7346646468855434501', '7346646468855467269', '7346646468855483653', '7346646468859530501', '7346646468859546885', '7346646468859579653', '7346646468859612421', '7346646468859628805', '7346646468859645189', '7346646468859661573', '7346646468859677957', '7346646468909862150', '7346646468909878534', '7346646468909878533', '7346646468909894918', '7346646468909894917', '7346646468909911301', '7346646468909927685', '7346646468909927686', '7346646468909944070', '7346646468909960453', '7346646468909960454', '7346646468909976838', '7346646468909993222', '7346646468910009605', '7346646468930850054', '7346646468930866438', '7346646468930899206', '7346646468930915590', '7346646468930931974', '7346646468930948358', '7346646468939222278', '7346646468939238662', '7346646468939271430', '7346646468939287814', '7346646468939353350', '7346646468943416581', '7346646468943498501', '7346646468981230881', '7346646468981247265', '7346646468981280033', '7346646469014719750', '7346646469014752518', '7346646469014818054', '7346646469014834438', '7346646469014850822', '7346646469014867206', '7346646469027302657', '7346646469027319041', '7346646469027351809', '7346646469027368193', '7346646469027400961', '7346646469027417345', '7346646469027450113', '7346646469031496965', '7346646469031513349', '7346646469031529733', '7346646469031562501', '7346646469031578885', '7346646469031595269', '7346646469031611653', '7346646469031644421', '7346646469035691282', '7346646469035756818', '7346646469035773202', '7346646469035789586', '7346646469035805970', '7346646469035838738', '7346646469048274182', '7346646469048323334', '7346646469048356102', '7346646469048372486', '7346646469048388870', '7346646469048421638', '7346646469056662790', '7346646469056679174', '7346646469056711942', '7346646469056728326', '7346646469056744710', '7346646469056761094', '7346646469056761120', '7346646469056793862', '7346646469056793888', '7346646469056810246', '7346646469060889857', '7346646469060922625', '7346646469073440032', '7346646469073456416', '7346646469090249989', '7346646469090299141', '7346646469090331909', '7346646469098622213', '7346646469098654981', '7346646469098687749', '7346646469098720517', '7346646469098736901', '7346646469098753285', '7346646469119577362', '7346646469119593746', '7346646469119610130', '7346646469119642898', '7346646469119659282', '7346646469119692050', '7346646469119708434', '7346646469140548869', '7346646469140565253', '7346646469140581637', '7346646469140630789', '7346646469140647173', '7346646469140679941', '7346646469161520390', '7346646469161536774', '7346646469161553158', '7346646469161569542', '7346646469161585926', '7346646469161602310', '7346646469161667846', '7346646469165731080', '7346646469165763848', '7346646469165796616', '7346646469165813000', '7346646469165829384', '7346646469165845768', '7346646469195091205', '7346646469195123973', '7346646469195156741', '7346646469195189509', '7346646469195205893', '7346646469228629254', '7346646469228645638', '7346646469228678406', '7346646469228694790', '7346646469228711174', '7346646469228727558', '7346646469228743942', '7346646469228776710', '7346646469249600773', '7346646469249633541', '7346646469249649925', '7346646469249682693', '7346646469249715461', '7346646469249748229', '7346646469316726021', '7346646469316807941', '7346646469316824325', '7346646469316840709', '7346646469316857093', '7346646469333536005', '7346646469333568773', '7346646469333585157', '7346646469333601541', '7346646469333634309', '7346646469362846977', '7346646469362863361', '7346646469362896129', '7346646469362912513', '7346646469362928897', '7346646469362945281', '7346646469362961665', '7346646469367041326', '7346646469367205166', '7346646469367237934', '7346646469367336238', '7346646469383818498', '7346646469383834882', '7346646469383851266', '7346646469383867650', '7346646469383884034', '7346646469383933186', '7346646469383949570', '7346646469388012805', '7346646469388045573', '7346646469388045574', '7346646469388061958', '7346646469388061957', '7346646469388078342', '7346646469388094726', '7346646469388094725', '7346646469388111110', '7346646469388127493', '7346646469388143877', '7346646469388160262', '7346646469392239877', '7346646469392256261', '7346646469392272645', '7346646469392289029', '7346646469392321797', '7346646469392354565', '7346646469413178630', '7346646469413211398', '7346646469413260550', '7346646469413293318', '7346646469417504043', '7346646469421600006', '7346646469421632774', '7346646469421649158', '7346646469421681926', '7346646469421698310', '7346646469421714694', '7346646469450927368', '7346646469450943752', '7346646469450976520', '7346646469450992904', '7346646469451009288', '7346646469451042056', '7346646469451058440', '7346646469451074824', '7346646469455138050', '7346646469455154434', '7346646469455219970', '7346646469455236354', '7346646469467704578', '7346646469467720962', '7346646469467737346', '7346646469467753730', '7346646469467753761', '7346646469467770114', '7346646469467786498', '7346646469467802913', '7346646469467835650', '7346646469467852034', '7346646469476093192', '7346646469476109570', '7346646469476125960', '7346646469476142338', '7346646469476142341', '7346646469476158725', '7346646469476158722', '7346646469476175112', '7346646469476191490', '7346646469476207874', '7346646469476224258', '7346646469476224261', '7346646469476224264', '7346646469476240645', '7346646469484481797', '7346646469484498181', '7346646469484530949', '7346646469484547333', '7346646469484580101', '7346646469484596485', '7346646469488725253', '7346646469488741637', '7346646469488774405', '7346646469488790789', '7346646469488807173', '7346646469488823557', '7346646469501259014', '7346646469501275398', '7346646469501291782', '7346646469501340934', '7346646469501357318', '7346646469501390086', '7346646469501406470', '7346646469530733830', '7346646469534813446', '7346646469534829857', '7346646469534846214', '7346646469534846241', '7346646469534862598', '7346646469534862625', '7346646469534878982', '7346646469534879009', '7346646469534895393', '7346646469543202054', '7346646469543251206', '7346646469543267590', '7346646469543283974', '7346646469543300358', '7346646469543349510', '7346646469568367902', '7346646469568400670', '7346646469568433438', '7346646469568466206', '7346646469576756482', '7346646469576772866', '7346646469576789250', '7346646469576805634', '7346646469576822018', '7346646469576838402', '7346646469576887554', '7346646469576903938', '7346646469580950802', '7346646469580967186', '7346646469580999954', '7346646469581016338', '7346646469581032722', '7346646469581065490', '7346646469581081874', '7346646469581098258', '7346646469585145093', '7346646469585161477', '7346646469585243397', '7346646469585259781', '7346646469585292549', '7346646469589355784', '7346646469589388552', '7346646469589421320', '7346646469589454088', '7346646469589486856', '7346646469593533716', '7346646469593550100', '7346646469593582868', '7346646469593599252', '7346646469593632020', '7346646469627088136', '7346646469627120904', '7346646469627153672', '7346646469627170056', '7346646469627202824', '7346646469627219208', '7346646469627235592', '7346646469631282437', '7346646469631282439', '7346646469631298823', '7346646469631298821', '7346646469631315207', '7346646469631315205', '7346646469631347975', '7346646469631364359', '7346646469631397127', '7346646469631413509', '7346646469631429895', '7346646469652253958', '7346646469652286726', '7346646469652303110', '7346646469652335878', '7346646469652385030', '7346646469652401414', '7346646469669031173', '7346646469669063941', '7346646469669080325', '7346646469669096709', '7346646469669145861', '7346646469669162245', '7346646469690019078', '7346646469690117382', '7346646469690133766', '7346646469694213381', '7346646469694295301', '7346646469694311685', '7346646469694328069', '7346646469694344453', '7346646469719362822', '7346646469719395590', '7346646469719411974', '7346646469719428358', '7346646469719444742', '7346646469719477510', '7346646469719493894', '7346646469723557125', '7346646469723589893', '7346646469723622661', '7346646469723639045', '7346646469723655429', '7346646469723671813', '7346646469731962118', '7346646469731994886', '7346646469732011270', '7346646469732027654', '7346646469732044038', '7346646469732093190', '7346646469748722945', '7346646469748739329', '7346646469748772097', '7346646469748821249', '7346646469748837633', '7346646469799054624', '7346646469799103776', '7346646469799120160', '7346646469799169312', '7346646469799202080', '7346646469803248904', '7346646469803265288', '7346646469803298053', '7346646469803298056', '7346646469803314437', '7346646469803314440', '7346646469803330821', '7346646469803330824', '7346646469803347205', '7346646469803363592', '7346646469803379976', '7346646469803396357', '7346646469803396360', '7346646469803445509', '7346646469803461893', '7346646469803560197', '7346646469811637509', '7346646469811653893', '7346646469811735813', '7346646469811752197', '7346646469811768581', '7346646469811784993', '7346646469832625440', '7346646469832690976', '7346646469832723744', '7346646469836852512', '7346646469836885280', '7346646469836950816', '7346646469840997675', '7346646469841030443', '7346646469841079595', '7346646469866163461', '7346646469866179845', '7346646469866228997', '7346646469866261765', '7346646469866278149', '7346646469891427627', '7346646469891444011', '7346646469916495147', '7346646469916527915', '7346646469916544299', '7346646469916560683', '7346646469916577067', '7346646469916642603', '7346646469933272328', '7346646469933288750', '7346646469933305096', '7346646469933321518', '7346646469933337864', '7346646469933354286', '7346646469933370632', '7346646469933387016', '7346646469933387054', '7346646469933354248', '7346646469933403400', '7346646469937483040', '7346646469937515808', '7346646469937532192', '7346646469937581344', '7346646469945920810', '7346646469945937194', '7346646469946002730', '7346646469962632454', '7346646469962632480', '7346646469962648838', '7346646469962648864', '7346646469962665222', '7346646469962665248', '7346646469962697990', '7346646469962714374', '7346646469962763552', '7346646469962779936', '7346646469971037445', '7346646469971053829', '7346646469971152133', '7346646469971168517', '7346646469975231745', '7346646469975264513', '7346646469975280897', '7346646469975297281', '7346646469975313665', '7346646469987814662', '7346646469987847430', '7346646469987880198', '7346646469987912966', '7346646469987945734', '7346646470000413958', '7346646470000430342', '7346646470000446726', '7346646470000463110', '7346646470000479494', '7346646470000512262', '7346646470000528646', '7346646470012964101', '7346646470012980485', '7346646470013029637', '7346646470013046021', '7346646470013078789', '7346646470013095173', '7346646470033935659', '7346646470033952043', '7346646470033968427', '7346646470033984811', '7346646470034001195', '7346646470034017579', '7346646470034033963', '7346646470034050347', '7346646470034066731', '7346646470034083115', '7346646470038129938', '7346646470038146322', '7346646470038179090', '7346646470038195474', '7346646470038211858', '7346646470038261010', '7346646470071684357', '7346646470071733509', '7346646470071749893', '7346646470071782661', '7346646470101060869', '7346646470101077253', '7346646470101093637', '7346646470101110021', '7346646470101126405', '7346646470101159173', '7346646470101191941', '7346646470113660166', '7346646470113692934', '7346646470113709318', '7346646470113742086', '7346646470113758470', '7346646470113774854', '7346646470122016005', '7346646470122032389', '7346646470122081541', '7346646470122130693', '7346646470122147077', '7346646470159764742', '7346646470159781126', '7346646470159797510', '7346646470159846662', '7346646470163959082', '7346646470163975431', '7346646470163991815', '7346646470164041002', '7346646470164057351', '7346646470164057386', '7346646470164073735', '7346646470164090119', '7346646470164090154', '7346646470164106503', '7346646470231067912', '7346646470231084296', '7346646470231117088', '7346646470231133448', '7346646470231149832', '7346646470231166240', '7346646470231182624', '7346646470231198984', '7346646470231199008', '7346646470231215392', '7346646470231215368', '7346646470243667206', '7346646470243683590', '7346646470243716358', '7346646470243749126', '7346646470252039430', '7346646470252055816', '7346646470252055814', '7346646470252072200', '7346646470252088582', '7346646470252088584', '7346646470252104966', '7346646470252104968', '7346646470252121352', '7346646470252137736', '7346646470252154118', '7346646470252154120', '7346646470306565381', '7346646470306565409', '7346646470306581765', '7346646470306598149', '7346646470306598177', '7346646470306614533', '7346646470306630917', '7346646470306630945', '7346646470306680097', '7346646470306696453', '7346646470306712837', '7346646470306712865', '7346646470331731205', '7346646470331829509', '7346646470331862277', '7346646470331878661', '7346646470344314118', '7346646470344330502', '7346646470344346886', '7346646470344363270', '7346646470344412422', '7346646470344428806', '7346646470344461574', '7346646470348524806', '7346646470348590342', '7346646470348623110', '7346646470352719110', '7346646470352735494', '7346646470352768262', '7346646470352801030', '7346646470352850182', '7346646470365744388', '7346646470365760771', '7346646470369479941', '7346646470369479956', '7346646470369496325', '7346646470369512710', '7346646470369512709', '7346646470369545478', '7346646470369545477', '7346646470369578245', '7346646470369578260', '7346646470369594629', '7346646470369611028', '7346646470369611013', '7346646470369627397', '7346646470369627412', '7346646470373772587', '7346646470373805355', '7346646470373821739', '7346646470399003920', '7346646470407245061', '7346646470407277829', '7346646470407294213', '7346646470407310597', '7346646470407359749', '7346646470411930892', '7346646470419811589', '7346646470419860741', '7346646470419877125', '7346646470419893509', '7346646470419942661', '7346646470424235268', '7346646470424481071', '7346646470432460044', '7346646470436900128', '7346646470437031220', '7346646470445387071', '7346646470445403410', '7346646470449302795', '7346646470453513480', '7346646470461754625', '7346646470461754629', '7346646470461771009', '7346646470461787397', '7346646470461852933', '7346646470461852929', '7346646470461869317', '7346646470461885697', '7346646470461885701', '7346646470461902081', '7346646470474337569', '7346646470474370337', '7346646470474435873', '7346646470474452257', '7346646470474485025', '7346646470491114795', '7346646470491245867', '7346646470516280581', '7346646470516296965', '7346646470516313349', '7346646470516346117', '7346646470516378885', '7346646470516395269', '7346646470516428037', '7346646470520491270', '7346646470520507654', '7346646470520524038', '7346646470520540422', '7346646470520556806', '7346646470520573190', '7346646470520589574', '7346646470520605958', '7346646470520622342', '7346646470533057797', '7346646470533074181', '7346646470533090565', '7346646470533106949', '7346646470533123333', '7346646470533139717', '7346646470533188869', '7346646470533205253', '7346646470600166688', '7346646470600183072', '7346646470600199456', '7346646470600215840', '7346646470600248608', '7346646470600264992', '7346646470600281376', '7346646470600314144', '7346646470616943890', '7346646470616993042', '7346646470617025810', '7346646470617042194', '7346646470617058578', '7346646470617091346', '7346646470646304018', '7346646470646320402', '7346646470646336786', '7346646470646353170', '7346646470646369554', '7346646470646435090', '7346646470654692614', '7346646470654708998', '7346646470654725382', '7346646470654741766', '7346646470654758150', '7346646470654774534', '7346646470654823686', '7346646470667275526', '7346646470667357446', '7346646470667390214', '7346646470667406598', '7346646470667422982', '7346646470684069126', '7346646470684101894', '7346646470684118278', '7346646470684151046', '7346646470688263430', '7346646470688279814', '7346646470688296198', '7346646470688312582', '7346646470688361734', '7346646470688378118', '7346646470696635653', '7346646470696652037', '7346646470696668421', '7346646470696684805', '7346646470696701189', '7346646470696717573', '7346646470696733957', '7346646470696750341', '7346646470696766725', '7346646470696783109', '7346646470705040646', '7346646470705089798', '7346646470705122566', '7346646470705155334', '7346646470717672747', '7346646470717705515', '7346646470730239274', '7346646470730255658', '7346646470730321194', '7346646470730337578', '7346646470742773025', '7346646470742789409', '7346646470742838561', '7346646470755437829', '7346646470755454213', '7346646470776327429', '7346646470776392965', '7346646470776409349', '7346646470776425733', '7346646470776442117', '7346646470776474885', '7346646470814076165', '7346646470814141701', '7346646470814158085', '7346646470814174469', '7346646470814207237', '7346646470814223621', '7346646470856019206', '7346646470856068358', '7346646470856133894', '7346646470860229895', '7346646470860246279', '7346646470860262663', '7346646470860311815', '7346646470860360967', '7346646470877089045', '7346646470877121813', '7346646470889573634', '7346646470889590018', '7346646470889622786', '7346646470889655554', '7346646470889671938', '7346646470889688322', '7346646470893817093', '7346646470893849861', '7346646470893882629', '7346646470893899013', '7346646470914739489', '7346646470914755873', '7346646470914772257', '7346646470914821409', '7346646470914854177', '7346646470914870561', '7346646470918933761', '7346646470918950145', '7346646470918999297', '7346646470918999328', '7346646470919015681', '7346646470919032096', '7346646470919048449', '7346646470919064833', '7346646470919081217', '7346646470927322374', '7346646470927387910', '7346646470927453446', '7346646470927469830', '7346646470952504609', '7346646470952537377', '7346646470952553761', '7346646470952586529', '7346646470952602913', '7346646470969265413', '7346646470969265438', '7346646470969281822', '7346646470969298206', '7346646470969330949', '7346646470969330974', '7346646470969347358', '7346646470969363742', '7346646470969380126', '7346646470969396510', '7346646470969412894', '7346646471023791365', '7346646471023807749', '7346646471023824133', '7346646471023840517', '7346646471023889669', '7346646471023906053', '7346646471023922437', '7346646471061605675', '7346646471065750790', '7346646471065816326', '7346646471065832710', '7346646471065865478', '7346646471103483142', '7346646471103499526', '7346646471103515910', '7346646471103532294', '7346646471103548678', '7346646471103565062', '7346646471103581446', '7346646471103597830', '7346646471103614214', '7346646471107693829', '7346646471107726597', '7346646471107742981', '7346646471107808517', '7346646471128648968', '7346646471128665352', '7346646471128698120', '7346646471128730888', '7346646471128780040', '7346646471132892424', '7346646471132908808', '7346646471132925192', '7346646471132941576', '7346646471132957960', '7346646471132974344', '7346646471141231878', '7346646471141248262', '7346646471141281030', '7346646471141346566', '7346646471145458951', '7346646471145491719', '7346646471145508103', '7346646471145524487', '7346646471149620485', '7346646471149636869', '7346646471149653253', '7346646471149686021', '7346646471149702405', '7346646471149718789', '7346646471149751557', '7346646471149751598', '7346646471149784366', '7346646471153863968', '7346646471153880352', '7346646471153896736', '7346646471158025490', '7346646471158041874', '7346646471158091026', '7346646471158123794', '7346646471158140178', '7346646471158156562', '7346646471170657554', '7346646471170706706', '7346646471170723090', '7346646471183174918', '7346646471183207686', '7346646471183240454', '7346646471183256838', '7346646471183273222', '7346646471183322374', '7346646471187385633', '7346646471187418401', '7346646471187500321', '7346646471204162822', '7346646471204195590', '7346646471204228358', '7346646471204244742', '7346646471204277510', '7346646471229541678', '7346646471229574446', '7346646471229607214', '7346646471241944352', '7346646471271255338', '7346646471271288106', '7346646471271304490', '7346646471271320874', '7346646471271402794', '7346646471300615457', '7346646471300648225', '7346646471300680993', '7346646471300746529', '7346646471300762913', '7346646471313198369', '7346646471313280289', '7346646471313296673', '7346646471313313057', '7346646471313345825', '7346646471321619717', '7346646471321652485', '7346646471321685253', '7346646471321701637', '7346646471321718021', '7346646471334235424', '7346646471334268192', '7346646471334300960', '7346646471334317344', '7346646471338396970', '7346646471338429738', '7346646471338446122', '7346646471392890117', '7346646471392890118', '7346646471392906502', '7346646471392906504', '7346646471392906501', '7346646471392922888', '7346646471392922885', '7346646471392939269', '7346646471392939272', '7346646471392955656', '7346646471392972037', '7346646471392972040', '7346646471392988422', '7346646471393004805', '7346646471393004808', '7346646471393021190', '7346646471393021192', '7346646471393021189', '7346646471393037576', '7346646471418072325', '7346646471418088709', '7346646471418137861', '7346646471418154245', '7346646471418170629', '7346646471418203397', '7346646471422250246', '7346646471422266630', '7346646471422283014', '7346646471422299397', '7346646471422315782', '7346646471422332166', '7346646471422348549', '7346646471422364934', '7346646471422381317', '7346646471422381318', '7346646471422397701', '7346646471422397702', '7346646471464193285', '7346646471464209669', '7346646471464258821', '7346646471464307973', '7346646471464324357', '7346646471464340741', '7346646471476808966', '7346646471476825350', '7346646471476874502', '7346646471485164806', '7346646471485246726', '7346646471485263110', '7346646471485295878', '7346646471485312262', '7346646471518719264', '7346646471518768416', '7346646471518850336', '7346646471518866720', '7346646471539707143', '7346646471539723527', '7346646471539772679', '7346646471539789063', '7346646471539805447', '7346646471539838215', '7346646471548079365', '7346646471548128517', '7346646471548161285', '7346646471548177669', '7346646471548194053', '7346646471548210437', '7346646471556500779', '7346646471556582699', '7346646471556599083', '7346646471590022405', '7346646471590038789', '7346646471590071557', '7346646471590087941', '7346646471590104325', '7346646471590137093', '7346646471590153477', '7346646471623576837', '7346646471623593221', '7346646471623609606', '7346646471623625989', '7346646471623625990', '7346646471623642373', '7346646471623658758', '7346646471623675141', '7346646471623724294', '7346646471623724293', '7346646471648775467', '7346646471652936965', '7346646471652953346', '7346646471652969733', '7346646471653002501', '7346646471653018885', '7346646471653035269', '7346646471653084421', '7346646471661505838', '7346646471661538606', '7346646471661636910', '7346646471682297093', '7346646471682313477', '7346646471682329861', '7346646471682362629', '7346646471682379013', '7346646471682395397', '7346646471682411781', '7346646471690767622', '7346646471690784006', '7346646471690800390', '7346646471690816774', '7346646471699074310', '7346646471699139846', '7346646471699156230', '7346646471699188998', '7346646471699205382', '7346646471699221766', '7346646471737183539', '7346646471770410246', '7346646471770443014', '7346646471770475782', '7346646471770492166', '7346646471770524934', '7346646471795543298', '7346646471795559682', '7346646471795576066', '7346646471795592450', '7346646471795608834', '7346646471795625218', '7346646471795657986', '7346646471795674370', '7346646471812336902', '7346646471812353286', '7346646471812386079', '7346646471812402463', '7346646471812418847', '7346646471812451615', '7346646471812467999', '7346646471824919809', '7346646471824952577', '7346646471824985345', '7346646471825034497', '7346646471829130529', '7346646471829146913', '7346646471829163297', '7346646471829196065', '7346646471829212449', '7346646471829228833', '7346646471829245217', '7346646471841680672', '7346646471841729824', '7346646471841778976', '7346646471841811744', '7346646471845874949', '7346646471845891333', '7346646471845907717', '7346646471845973253', '7346646471845989637', '7346646471846006021', '7346646471846022405', '7346646471854263557', '7346646471854279941', '7346646471854296325', '7346646471854312709', '7346646471854329093', '7346646471854378245', '7346646471854394629', '7346646471854411013', '7346646471862652162', '7346646471862668546', '7346646471862684930', '7346646471862750466', '7346646471862799618', '7346646471900400902', '7346646471900417286', '7346646471900450054', '7346646471900466438', '7346646471900482822', '7346646471900499206', '7346646471900531974', '7346646471900548358', '7346646471917178117', '7346646471917194501', '7346646471917210885', '7346646471917243653', '7346646471917260037', '7346646471917292805', '7346646471917309189', '7346646471921388806', '7346646471921421574', '7346646471921437958', '7346646471921470726', '7346646471938149638', '7346646471938182406', '7346646471938215174', '7346646471938231558', '7346646471938247942', '7346646471938264326', '7346646471975914757', '7346646471975980293', '7346646471976029445', '7346646472009452802', '7346646472009518338', '7346646472009551106', '7346646472009567490', '7346646472009583874', '7346646472009600258', '7346646472017841414', '7346646472017874182', '7346646472017890566', '7346646472017923334', '7346646472017939718', '7346646472043023621', '7346646472043040005', '7346646472043056389', '7346646472043105541', '7346646472043138309', '7346646472051445024', '7346646472051461408', '7346646472051494176', '7346646472051543328', '7346646472055590152', '7346646472055606536', '7346646472055622920', '7346646472055639304', '7346646472055655688', '7346646472063995138', '7346646472064027906', '7346646472064077058', '7346646472064126210', '7346646472072400135', '7346646472072449287', '7346646472072465671', '7346646472072498439', '7346646472072514823', '7346646472143686944', '7346646472143719712', '7346646472143736096', '7346646472143752480', '7346646472143818016', '7346646472147881222', '7346646472147913990', '7346646472147946758', '7346646472147963142', '7346646472148012294', '7346646472156253446', '7346646472156269830', '7346646472156302598', '7346646472156318982', '7346646472156368134', '7346646472156400902', '7346646472160447750', '7346646472160464134', '7346646472160496902', '7346646472160513286', '7346646472160529670', '7346646472160546054', '7346646472160562438', '7346646472160595206', '7346646472177241376', '7346646472177290528', '7346646472177372448', '7346646472189824261', '7346646472189906181', '7346646472189938949', '7346646472189955333', '7346646472202407200', '7346646472202439968', '7346646472202538272', '7346646472240188677', '7346646472240205061', '7346646472240254213', '7346646472240270597', '7346646472240286981', '7346646472248528133', '7346646472248577285', '7346646472248593669', '7346646472248610053', '7346646472248659205', '7346646472248675589', '7346646472252722437', '7346646472252722438', '7346646472252738821', '7346646472252755205', '7346646472252755206', '7346646472252787974', '7346646472252820741', '7346646472252837125', '7346646472252853510', '7346646472252869893', '7346646472256949511', '7346646472256965895', '7346646472256998663', '7346646472257047815', '7346646472277888262', '7346646472277904646', '7346646472277970182', '7346646472277986566', '7346646472278002950', '7346646472278019334', '7346646472278035718', '7346646472298892545', '7346646472298925313', '7346646472298941697', '7346646472298958081', '7346646472298974465', '7346646472298990849', '7346646472307248389', '7346646472307281157', '7346646472307297541', '7346646472307313925', '7346646472307379461', '7346646472307395845', '7346646472311442695', '7346646472311459092', '7346646472311491860', '7346646472311491847', '7346646472311524615', '7346646472311524628', '7346646472311541012', '7346646472311557396', '7346646472311557383', '7346646472311573767', '7346646472311590151', '7346646472319880466', '7346646472319896850', '7346646472319929618', '7346646472319946002', '7346646472319962386', '7346646472344997125', '7346646472344997138', '7346646472345013509', '7346646472345029893', '7346646472345029906', '7346646472345046277', '7346646472345046290', '7346646472345062661', '7346646472345111813', '7346646472345128197', '7346646472345128210', '7346646472349191430', '7346646472349240582', '7346646472349256966', '7346646472349306118', '7346646472365985030', '7346646472366050566', '7346646472366083334', '7346646472454065426', '7346646472454081810', '7346646472454130962', '7346646472454180114', '7346646472454196498', '7346646472458259755', '7346646472458308907', '7346646472458390827', '7346646472462454022', '7346646472462470406', '7346646472462519558', '7346646472462535942', '7346646472462585094', '7346646472479313185', '7346646472500235526', '7346646472500186374', '7346646472500268294', '7346646472500333830', '7346646472533757190', '7346646472533806342', '7346646472533871878', '7346646472533904646', '7346646472533937414', '7346646472533986566', '7346646472534019334', '7346646472534035718', '7346646472534052102', '7346646472533970182', '7346646472596688134', '7346646472596704518', '7346646472596720902', '7346646472596737286', '7346646472596770054', '7346646472596786438', '7346646472621837574', '7346646472621853958', '7346646472621886726', '7346646472621919494', '7346646472621952262', '7346646472642792710', '7346646472642825478', '7346646472642841862', '7346646472642891014', '7346646472642940166', '7346646472642923782', '7346646472651181333', '7346646472651197717', '7346646472651214101', '7346646472651263253', '7346646472651279637', '7346646472651296021', '7346646472684899630', '7346646472684932398', '7346646472684965166', '7346646472684997934', '7346646472697367813', '7346646472697384197', '7346646472697400581', '7346646472697416965', '7346646472697433349', '7346646472697449733', '7346646472697466117', '7346646472705707270', '7346646472705772806', '7346646472705821958', '7346646472705838342', '7346646472714145030', '7346646472714177798', '7346646472714194182', '7346646472718306566', '7346646472718322950', '7346646472718372102', '7346646472718404870', '7346646472718421254', '7346646472722484486', '7346646472722500870', '7346646472722517254', '7346646472722533638', '7346646472722631942', '7346646472726678789', '7346646472726711557', '7346646472726727941', '7346646472726793477', '7346646472726809861', '7346646472726826245', '7346646472730873090', '7346646472730889474', '7346646472730922242', '7346646472730905858', '7346646472730938626', '7346646472730955010', '7346646472730971394', '7346646472730987778', '7346646472731004162', '7346646472731020546', '7346646472735083782', '7346646472735182086', '7346646472735198470', '7346646472735214854', '7346646472743456002', '7346646472743488770', '7346646472756104491', '7346646472756153643', '7346646472756186411', '7346646472764427562', '7346646472764476714', '7346646472789593375', '7346646472789609759', '7346646472789642527', '7346646472789675295', '7346646472789691679', '7346646472789724447', '7346646472789740831', '7346646472814759174', '7346646472814791942', '7346646472814824710', '7346646472814857478', '7346646472814890246', '7346646472814906630', '7346646472835730694', '7346646472835828998', '7346646472835845382', '7346646472835878150', '7346646472844119301', '7346646472844168453', '7346646472844184837', '7346646472844250373', '7346646472844266757', '7346646472856702214', '7346646472856734982', '7346646472856751366', '7346646472856767750', '7346646472856784134', '7346646472856816902', '7346646472856833286']


def download_metadata(video_id: str) -> dict:
    """
    downloads metadata for a YouTube video
    :param video_id: 11 character video ID
    :return: metadata dict
    """
    ydl_opts = {
        "skip_download": True,
        "quiet": True,
        "noprogress": True
    }
    tries = 0
    while tries < 3:
        print(video_id.split("/")[-1])
        with yt_dlp.YoutubeDL(ydl_opts) as ydl:
            try:
                info_dict = ydl.sanitize_info(ydl.extract_info(video_id, download=False))
                print(info_dict["id"])
                # print(json.dumps(info_dict, indent=4))
                return info_dict
            except Exception as e:
                if "No video formats found!" in str(e):
                    return {
                        "id": video_id.split("/")[-1],
                        "title": "No video formats found! (likely photo)"
                    }
                if "status code 10222" in str(e):
                    return {
                        "id": video_id.split("/")[-1],
                        "title": "status code 10222: likely private or deleted"
                    }
                print(e)
                tries += 1
                if tries == 3:
                    return {
                        "id": video_id.split("/")[-1],
                        "title": "ERROR",
                        "description": str(e)
                    }
                sleep(3)
#
#
# with tqdm(total=len(sampled_ids)) as pbar:
#     with ThreadPoolExecutor(max_workers=1) as executor:
#         results = []
#         futures = [executor.submit(download_metadata, f"https://www.tiktok.com/@/video/{sampled_id}") for sampled_id in sampled_ids[0:5]]
#         for future in as_completed(futures):
#             results.append(future.result())
#             pbar.update(1)
# with open("metadata.json", "w") as f:
#     print(json.dumps(results[0]))
#     print(json.dumps(results[1]))
#     json.dump(results, f)
# with open("metadata.json", "r") as f:
#     metadata_dicts = json.load(f)
#     df = pd.read_json(f)
#     print(df)
#     # df.to_csv("metadata.csv")
